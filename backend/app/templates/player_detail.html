{% extends "layout.html" %}

{% block title %}{{ player.name if player else 'Player' }} - Hoops Tracker{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    {% if player %}
    <!-- Player Header -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="w-16 h-16 bg-nba-blue rounded-full flex items-center justify-center text-white text-2xl font-bold">
                    {{ player.name[0] }}
                </div>
                <div>
                    <h1 class="text-3xl font-bold text-gray-900">{{ player.name }}</h1>
                    <div class="flex items-center space-x-4 text-gray-600">
                        <span class="font-medium">{{ player.position or 'N/A' }}</span>
                        <span>‚Ä¢</span>
                        <span>{{ player.teams.name if player.teams else 'Free Agent' }}</span>
                        {% if player.jersey_number %}
                        <span>‚Ä¢</span>
                        <span>#{{ player.jersey_number }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="flex space-x-2">
                <button class="btn-primary" onclick="addToWatchlist('{{ player.id }}')">
                    Add to Watchlist
                </button>
                <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded" onclick="openBetModal('{{ player.id }}')">
                    Place Bet
                </button>
            </div>
        </div>
    </div>

    <!-- Player Stats Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <!-- Season Averages -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold mb-4">2024-25 Season Averages</h3>
            <div class="space-y-3">
                <div class="flex justify-between">
                    <span class="text-gray-600">Points:</span>
                    <span class="font-semibold">{{ player.avg_points or 'N/A' }}</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Rebounds:</span>
                    <span class="font-semibold">{{ player.avg_rebounds or 'N/A' }}</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Assists:</span>
                    <span class="font-semibold">{{ player.avg_assists or 'N/A' }}</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">FG%:</span>
                    <span class="font-semibold">{{ player.fg_percentage or 'N/A' }}</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">Minutes:</span>
                    <span class="font-semibold">{{ player.avg_minutes or 'N/A' }}</span>
                </div>
            </div>
        </div>

        <!-- Recent Form -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold mb-4">Last 5 Games</h3>
            <div class="space-y-2">
                {% for game in recent_games[:5] %}
                <div class="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0">
                    <div class="text-sm">
                        <div class="font-medium">vs {{ game.opponent or 'TBD' }}</div>
                        <div class="text-gray-500">{{ game.game_date.strftime('%m/%d') if game.game_date else 'TBD' }}</div>
                    </div>
                    <div class="text-right text-sm">
                        <div class="font-semibold">{{ game.points or 0 }} PTS</div>
                        <div class="text-gray-500">{{ game.rebounds or 0 }}R {{ game.assists or 0 }}A</div>
                    </div>
                </div>
                {% else %}
                <p class="text-gray-500 text-center py-4">No recent games available</p>
                {% endfor %}
            </div>
        </div>

        <!-- Player Info -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h3 class="text-lg font-semibold mb-4">Player Info</h3>
            <div class="space-y-3">
                {% if player.height %}
                <div class="flex justify-between">
                    <span class="text-gray-600">Height:</span>
                    <span class="font-semibold">{{ player.height }}</span>
                </div>
                {% endif %}
                {% if player.weight %}
                <div class="flex justify-between">
                    <span class="text-gray-600">Weight:</span>
                    <span class="font-semibold">{{ player.weight }} lbs</span>
                </div>
                {% endif %}
                {% if player.college %}
                <div class="flex justify-between">
                    <span class="text-gray-600">College:</span>
                    <span class="font-semibold">{{ player.college }}</span>
                </div>
                {% endif %}
                {% if player.draft_year %}
                <div class="flex justify-between">
                    <span class="text-gray-600">Draft:</span>
                    <span class="font-semibold">{{ player.draft_year }}</span>
                </div>
                {% endif %}
                <div class="flex justify-between">
                    <span class="text-gray-600">Status:</span>
                    <span class="font-semibold {{ 'text-green-600' if player.is_active else 'text-red-600' }}">
                        {{ 'Active' if player.is_active else 'Inactive' }}
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Log Table -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold">Game Log</h3>
        </div>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Opponent</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MIN</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">PTS</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">REB</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">AST</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">FG%</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">+/-</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for game in stats %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {{ game.game_date.strftime('%m/%d/%Y') if game.game_date else 'TBD' }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {{ game.opponent or 'TBD' }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {{ game.minutes_played or '-' }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                            {{ game.points or 0 }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {{ game.rebounds or 0 }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {{ game.assists or 0 }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                            {{ game.fg_percentage or '-' }}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm {{ 'text-green-600' if (game.plus_minus or 0) > 0 else 'text-red-600' if (game.plus_minus or 0) < 0 else 'text-gray-900' }}">
                            {{ '+' if (game.plus_minus or 0) > 0 else '' }}{{ game.plus_minus or 0 }}
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="8" class="px-6 py-4 text-center text-gray-500">
                            No game data available
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <!-- Player Not Found -->
    <div class="text-center py-12">
        <div class="text-6xl mb-4">üèÄ</div>
        <h1 class="text-2xl font-bold text-gray-900 mb-2">Player Not Found</h1>
        <p class="text-gray-600 mb-4">The player you're looking for doesn't exist or has been removed.</p>
        <a href="/players" class="btn-primary">Browse All Players</a>
    </div>
    {% endif %}
</div>

<!-- Bet Modal (placeholder) -->
<div id="betModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
        <h3 class="text-lg font-semibold mb-4">Place Bet on {{ player.name if player else 'Player' }}</h3>
        <p class="text-gray-600 mb-4">Betting functionality will be available soon!</p>
        <button onclick="closeBetModal()" class="btn-primary w-full">Close</button>
    </div>
</div>

<script>
function addToWatchlist(playerId) {
    // TODO: Implement add to watchlist
    alert('Watchlist functionality coming soon!');
}

function openBetModal(playerId) {
    document.getElementById('betModal').classList.remove('hidden');
}

function closeBetModal() {
    document.getElementById('betModal').classList.add('hidden');
}
</script>
{% endblock %}